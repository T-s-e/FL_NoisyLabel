[21:14:06.146] Namespace(deterministic=1, seed=0, gpu='1', exp='FedNoRo', dataset='Camelyon17', model='Resnet18', batch_size=16, base_lr=0.0003, pretrained=0, n_clients=20, iid=0, non_iid_prob_class=0.9, alpha_dirichlet=2.0, local_ep=5, rounds=100, s1=10, begin=10, end=49, a=0.8, warm=1, level_n_system=0.5, level_n_lowerb=0.5, level_n_upperb=0.7, n_type='instance', num_users=20, device='cuda')
[21:14:06.338] train: Counter({0: 25000, 1: 25000}), total: 50000
[21:14:06.339] test: Counter({0: 5000, 1: 5000}), total: 10000
[21:14:06.340] Client 1, noise level: 0.6058, real noise ratio: 0.6057
[21:14:06.341] Client 3, noise level: 0.6851, real noise ratio: 0.6850
[21:14:06.342] Client 6, noise level: 0.5040, real noise ratio: 0.5038
[21:14:06.342] Client 8, noise level: 0.6556, real noise ratio: 0.6552
[21:14:06.343] Client 9, noise level: 0.6740, real noise ratio: 0.6734
[21:14:06.344] Client 10, noise level: 0.6957, real noise ratio: 0.6955
[21:14:06.344] Client 12, noise level: 0.5923, real noise ratio: 0.5921
[21:14:06.345] Client 13, noise level: 0.6561, real noise ratio: 0.6560
[21:14:06.346] Client 16, noise level: 0.5287, real noise ratio: 0.5283
[21:14:06.347] Client 17, noise level: 0.6889, real noise ratio: 0.6889
[21:14:11.046] client0 each class num: [1208, 1166], total: 2374
[21:14:11.063] client1 each class num: [1343, 1338], total: 2681
[21:14:11.080] client2 each class num: [1635, 1694], total: 3329
[21:14:11.107] client3 each class num: [883, 898], total: 1781
[21:14:11.131] client4 each class num: [1235, 1279], total: 2514
[21:14:11.149] client5 each class num: [1665, 1714], total: 3379
[21:14:11.166] client6 each class num: [1210, 1142], total: 2352
[21:14:11.184] client7 each class num: [1465, 1439], total: 2904
[21:14:11.201] client8 each class num: [963, 1035], total: 1998
[21:14:11.225] client9 each class num: [807, 822], total: 1629
[21:14:11.252] client10 each class num: [844, 877], total: 1721
[21:14:11.270] client11 each class num: [1825, 1835], total: 3660
[21:14:11.287] client12 each class num: [740, 753], total: 1493
[21:14:11.305] client13 each class num: [1553, 1563], total: 3116
[21:14:11.322] client14 each class num: [600, 592], total: 1192
[21:14:11.340] client15 each class num: [1874, 1879], total: 3753
[21:14:11.374] client16 each class num: [923, 947], total: 1870
[21:14:11.392] client17 each class num: [1807, 1851], total: 3658
[21:14:11.409] client18 each class num: [1143, 1110], total: 2253
[21:14:11.427] client19 each class num: [1141, 1202], total: 2343
[21:14:11.427] 
 ---------------------begin training---------------------
[21:14:11.427] 
 ---------------------Stage 1: warm up---------------------
[21:14:11.427] 
 ---------------------client selection---------------------
[21:14:11.427] ********************** load model from: /home/xkx/pro/FedNoRo/outputs_Camelyon17_0.5_0.5_0.7/FedNoRo_0.5_0.5_0.7_5/models/stage1_model_9.pth **********************
[21:15:24.524] Namespace(deterministic=1, seed=0, gpu='1', exp='FedNoRo', dataset='Camelyon17', model='Resnet18', batch_size=16, base_lr=0.0003, pretrained=0, n_clients=20, iid=0, non_iid_prob_class=0.9, alpha_dirichlet=2.0, local_ep=5, rounds=100, s1=10, begin=10, end=49, a=0.8, warm=1, level_n_system=0.5, level_n_lowerb=0.5, level_n_upperb=0.7, n_type='instance', num_users=20, device='cuda')
[21:15:24.730] train: Counter({0: 25000, 1: 25000}), total: 50000
[21:15:24.731] test: Counter({0: 5000, 1: 5000}), total: 10000
[21:15:24.733] Client 1, noise level: 0.6058, real noise ratio: 0.6057
[21:15:24.734] Client 3, noise level: 0.6851, real noise ratio: 0.6850
[21:15:24.734] Client 6, noise level: 0.5040, real noise ratio: 0.5038
[21:15:24.735] Client 8, noise level: 0.6556, real noise ratio: 0.6552
[21:15:24.736] Client 9, noise level: 0.6740, real noise ratio: 0.6734
[21:15:24.736] Client 10, noise level: 0.6957, real noise ratio: 0.6955
[21:15:24.737] Client 12, noise level: 0.5923, real noise ratio: 0.5921
[21:15:24.738] Client 13, noise level: 0.6561, real noise ratio: 0.6560
[21:15:24.739] Client 16, noise level: 0.5287, real noise ratio: 0.5283
[21:15:24.740] Client 17, noise level: 0.6889, real noise ratio: 0.6889
[21:15:28.768] client0 each class num: [1208, 1166], total: 2374
[21:15:28.785] client1 each class num: [1343, 1338], total: 2681
[21:15:28.802] client2 each class num: [1635, 1694], total: 3329
[21:15:28.818] client3 each class num: [883, 898], total: 1781
[21:15:28.836] client4 each class num: [1235, 1279], total: 2514
[21:15:28.853] client5 each class num: [1665, 1714], total: 3379
[21:15:28.870] client6 each class num: [1210, 1142], total: 2352
[21:15:28.888] client7 each class num: [1465, 1439], total: 2904
[21:15:28.905] client8 each class num: [963, 1035], total: 1998
[21:15:28.922] client9 each class num: [807, 822], total: 1629
[21:15:28.939] client10 each class num: [844, 877], total: 1721
[21:15:28.956] client11 each class num: [1825, 1835], total: 3660
[21:15:28.973] client12 each class num: [740, 753], total: 1493
[21:15:28.991] client13 each class num: [1553, 1563], total: 3116
[21:15:29.008] client14 each class num: [600, 592], total: 1192
[21:15:29.025] client15 each class num: [1874, 1879], total: 3753
[21:15:29.042] client16 each class num: [923, 947], total: 1870
[21:15:29.060] client17 each class num: [1807, 1851], total: 3658
[21:15:29.077] client18 each class num: [1143, 1110], total: 2253
[21:15:29.094] client19 each class num: [1141, 1202], total: 2343
[21:15:29.095] 
 ---------------------begin training---------------------
[21:15:29.095] 
 ---------------------Stage 1: warm up---------------------
[21:15:29.095] 
 ---------------------client selection---------------------
[21:15:29.095] ********************** load model from: /home/xkx/pro/FedNoRo/outputs_Camelyon17_0.5_0.5_0.7/FedNoRo_0.5_0.5_0.7_5/models/stage1_model_9.pth **********************
[21:18:09.102] Namespace(deterministic=1, seed=0, gpu='1', exp='FedNoRo', dataset='Camelyon17', model='Resnet18', batch_size=16, base_lr=0.0003, pretrained=0, n_clients=20, iid=0, non_iid_prob_class=0.9, alpha_dirichlet=2.0, local_ep=5, rounds=100, s1=10, begin=10, end=49, a=0.8, warm=1, level_n_system=0.5, level_n_lowerb=0.5, level_n_upperb=0.7, n_type='instance', num_users=20, device='cuda')
[21:18:09.264] train: Counter({0: 25000, 1: 25000}), total: 50000
[21:18:09.265] test: Counter({0: 5000, 1: 5000}), total: 10000
[21:18:09.266] Client 1, noise level: 0.6058, real noise ratio: 0.6057
[21:18:09.267] Client 3, noise level: 0.6851, real noise ratio: 0.6850
[21:18:09.268] Client 6, noise level: 0.5040, real noise ratio: 0.5038
[21:18:09.269] Client 8, noise level: 0.6556, real noise ratio: 0.6552
[21:18:09.269] Client 9, noise level: 0.6740, real noise ratio: 0.6734
[21:18:09.270] Client 10, noise level: 0.6957, real noise ratio: 0.6955
[21:18:09.271] Client 12, noise level: 0.5923, real noise ratio: 0.5921
[21:18:09.272] Client 13, noise level: 0.6561, real noise ratio: 0.6560
[21:18:09.272] Client 16, noise level: 0.5287, real noise ratio: 0.5283
[21:18:09.274] Client 17, noise level: 0.6889, real noise ratio: 0.6889
[21:18:13.583] client0 each class num: [1208, 1166], total: 2374
[21:18:13.600] client1 each class num: [1343, 1338], total: 2681
[21:18:13.617] client2 each class num: [1635, 1694], total: 3329
[21:18:13.633] client3 each class num: [883, 898], total: 1781
[21:18:13.650] client4 each class num: [1235, 1279], total: 2514
[21:18:13.668] client5 each class num: [1665, 1714], total: 3379
[21:18:13.685] client6 each class num: [1210, 1142], total: 2352
[21:18:13.703] client7 each class num: [1465, 1439], total: 2904
[21:18:13.720] client8 each class num: [963, 1035], total: 1998
[21:18:13.737] client9 each class num: [807, 822], total: 1629
[21:18:13.754] client10 each class num: [844, 877], total: 1721
[21:18:13.772] client11 each class num: [1825, 1835], total: 3660
[21:18:13.789] client12 each class num: [740, 753], total: 1493
[21:18:13.806] client13 each class num: [1553, 1563], total: 3116
[21:18:13.823] client14 each class num: [600, 592], total: 1192
[21:18:13.841] client15 each class num: [1874, 1879], total: 3753
[21:18:13.858] client16 each class num: [923, 947], total: 1870
[21:18:13.875] client17 each class num: [1807, 1851], total: 3658
[21:18:13.892] client18 each class num: [1143, 1110], total: 2253
[21:18:13.910] client19 each class num: [1141, 1202], total: 2343
[21:18:13.910] 
 ---------------------begin training---------------------
[21:18:13.910] 
 ---------------------Stage 1: warm up---------------------
[21:28:26.347] ******** round: 0, acc: 0.5000, bacc: 0.5000 ********
[21:28:26.347] [[5000    0]
 [5000    0]]
[21:28:26.347] best bacc: 0.5, now bacc: 0.5
[21:28:26.348] 

[21:38:34.466] ******** round: 1, acc: 0.5000, bacc: 0.5000 ********
[21:38:34.466] [[5000    0]
 [5000    0]]
[21:38:34.467] best bacc: 0.5, now bacc: 0.5
[21:38:34.467] 

[21:48:43.266] ******** round: 2, acc: 0.5000, bacc: 0.5000 ********
[21:48:43.266] [[5000    0]
 [5000    0]]
[21:48:43.267] best bacc: 0.5, now bacc: 0.5
[21:48:43.267] 

[21:58:43.375] ******** round: 3, acc: 0.5000, bacc: 0.5000 ********
[21:58:43.376] [[5000    0]
 [5000    0]]
[21:58:43.376] best bacc: 0.5, now bacc: 0.5
[21:58:43.376] 

[22:08:48.110] ******** round: 4, acc: 0.5000, bacc: 0.5000 ********
[22:08:48.110] [[5000    0]
 [5000    0]]
[22:08:48.111] best bacc: 0.5, now bacc: 0.5
[22:08:48.111] 

[22:19:05.079] ******** round: 5, acc: 0.5217, bacc: 0.5217 ********
[22:19:05.079] [[5000    0]
 [4783  217]]
[22:19:05.080] best bacc: 0.5217, now bacc: 0.5217
[22:19:05.081] 

[22:29:13.721] ******** round: 6, acc: 0.5494, bacc: 0.5494 ********
[22:29:13.721] [[5000    0]
 [4506  494]]
[22:29:13.722] best bacc: 0.5494, now bacc: 0.5494
[22:29:13.722] 

[22:39:23.229] ******** round: 7, acc: 0.6524, bacc: 0.6524 ********
[22:39:23.229] [[5000    0]
 [3476 1524]]
[22:39:23.230] best bacc: 0.6524, now bacc: 0.6524
[22:39:23.230] 

[22:49:26.723] ******** round: 8, acc: 0.6936, bacc: 0.6936 ********
[22:49:26.723] [[4999    1]
 [3063 1937]]
[22:49:26.723] best bacc: 0.6936, now bacc: 0.6936
[22:49:26.724] 

[22:59:32.762] ******** round: 9, acc: 0.8348, bacc: 0.8348 ********
[22:59:32.763] [[4995    5]
 [1647 3353]]
[22:59:32.763] best bacc: 0.8348, now bacc: 0.8348
[22:59:32.764] 

[22:59:32.843] 
 ---------------------client selection---------------------
[22:59:32.844] ********************** load model from: /home/xkx/pro/FedNoRo/outputs_Camelyon17_0.5_0.5_0.7/FedNoRo_0.5_0.5_0.7_5/models/stage1_model_9.pth **********************
[23:01:23.965] local_output: (50000, 2), loss: (50000,)
[23:01:24.010] metrics:
[23:01:24.010] [[1.35551642e-02 3.02423625e-02]
 [8.91553073e-01 8.46727716e-01]
 [1.22458804e-02 4.50640427e-02]
 [1.00000000e+00 9.39653597e-01]
 [4.71652695e-04 7.04673922e-02]
 [2.51206675e-02 0.00000000e+00]
 [6.92223477e-01 7.46476204e-01]
 [1.22268996e-02 2.97394797e-02]
 [9.27747990e-01 9.46517401e-01]
 [9.41877406e-01 9.25737859e-01]
 [9.73914550e-01 9.95626268e-01]
 [1.44094388e-02 4.63290353e-02]
 [8.37462193e-01 8.47911697e-01]
 [8.88748484e-01 9.34727217e-01]
 [7.94072520e-04 8.17928744e-02]
 [0.00000000e+00 1.27769310e-01]
 [8.18715426e-01 6.86503604e-01]
 [9.26668230e-01 1.00000000e+00]
 [1.16286380e-02 4.76481515e-02]
 [1.60837810e-02 1.12599139e-02]]
[23:01:24.036] selected noisy clients: [1, 3, 6, 8, 9, 10, 12, 13, 16, 17], real noisy clients: [ 1  3  6  8  9 10 12 13 16 17]
[23:01:24.036] selected clean clients: [0, 2, 4, 5, 7, 11, 14, 15, 18, 19]
[23:01:24.036] 
 ---------------------Stage 2---------------------
[23:01:24.044] Round 10: client 0
[23:01:24.045] idx: 0, device: cuda
